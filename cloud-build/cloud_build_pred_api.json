{
    "steps": [
      {
        "name": "gcr.io/cloud-builders/docker",
        "args": [
          "build",
          "-t",
          "${_LOCATION}-docker.pkg.dev/$PROJECT_ID/${_REPOSITORY}/prediction-api:0.0.1",
          "./prediction-api"
        ]
      },
      {
        "name": "gcr.io/cloud-builders/docker",
        "args": [
          "push",
          "${_LOCATION}-docker.pkg.dev/$PROJECT_ID/${_REPOSITORY}/prediction-api:0.0.1"
        ]
      },
      {
        "name": "gcr.io/google.com/cloudsdktool/cloud-sdk",
        "entrypoint": "gcloud",
        "args": [
          "run",
          "deploy",
          "prediction-api",
          "--image",
          "${_LOCATION}-docker.pkg.dev/$PROJECT_ID/${_REPOSITORY}/prediction-api:0.0.1",
          "--region",
          "us-central1",
          "--platform",
          "managed",
          "--port",
          "5000",
          "--cpu",
          "2",
          "--memory",
          "4G",
          "--allow-unauthenticated",
          "--update-env-vars",
          "PROJECT_ID=$YOUR_PROJECT_ID,MODEL_REPO=$YOUR_MODEL_REPO,MODEL_NAME=insurance_pred",
          "--no-cpu-throttling"
        ]
      }
    ]
  }